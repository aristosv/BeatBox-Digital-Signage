#!/bin/bash

# variables
currentdir=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
source "$currentdir/../operations/variables"

echo =============================================================================================
echo - This will enable email alerts for cpu/disk/memory/temperature usage.
echo - You will be asked to provide the username and password of a gmail account.
echo - Perform the following steps to enable access to a gmail account before proceeding.
echo ---------------------------------------------------------------------------------------------
echo 1. Visit https://myaccount.google.com/lesssecureapps to enable less secure app access.
echo 2. Visit https://accounts.google.com/DisplayUnlockCaptcha to allow access to a gmail account.
echo =============================================================================================
read -p "press enter to continue"

echo gmail address: ; read gmailaddress ; export gmailaddress
echo gmail password: ; read gmailpassword ; export gmailpassword

install () {
 if test -f "/etc/systemd/system/cpumonitor.service" ; then
  $currentdir/function_remove_services
  $currentdir/function_create_services
  $currentdir/function_configure_services
  $workingdir/functions/function_reload
  $currentdir/function_enable_services
 else
  $currentdir/function_install_ssmtp
  $currentdir/function_configure_ssmtp
  $currentdir/function_create_services
  $currentdir/function_configure_services
  $workingdir/functions/function_reload
  $currentdir/function_enable_services
 fi
}